<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CART - TOKIRA SHOP</title>
    <link rel="shortcut icon" href="./image/icon.png" type="image/x-icon" />

    <link rel="stylesheet" href="./css/reset.css">
    <link rel="stylesheet" href="./css/cart.css">
    <link rel="stylesheet" href="./css/productwrap.css">

    <script src="https://kit.fontawesome.com/9c638736ac.js" crossorigin="anonymous"></script>
    <script src="./js/jquery-3.7.1.js"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@500;700;900&family=Syncopate:wght@700&display=swap" rel="stylesheet">
</head>
<body>
    
    <div class="wrap">
        <div id="header"></div>

        <div class="cartmain" id="top">
            <div class="banner">
                <div class="itemgroup">
                    <h2>MY CART</h2>
                    <div class="item">
                        <a href="shoppage.html" class="primg">
                            <img src="./image/product_gameboy.jpg" alt="gameboy">
                        </a>

                        <div class="text">
                            <div class="title">
                                <span class="name">掌上電子遊戲機</span>
                                <span class="comm" style="display: none;">980</span>
                                <span>$<span class="total">980</span></span>
                            </div>
        
                            <div class="detail">
                                <div class="count">
                                    <input type="button" value="-" class="minus">
                                    <input type="text" value="1">
                                    <input type="button" value="+" class="add">
                                </div>
                                
                                <a href="#" class="remove">
                                    <img src="./image/cart_can.svg" alt="remove">
                                    <img src="./image/cart_cano.svg" alt="remove">
                                </a>
                            </div>
                        </div>
                    </div>  
                    
                    <div class="item">
                        <a href="shoppage.html" class="primg">
                            <img src="./image/product_poster.jpg" alt="poster">
                        </a>

                        <div class="text">
                            <div class="title">
                                <span class="name">電影海報收藏品</span>
                                <span class="comm" style="display: none;">540</span>
                                <span>$<span class="total">540</span></span>
                            </div>
        
                            <div class="detail">
                                <div class="count">
                                    <input type="button" value="-" class="minus">
                                    <input type="text" value="1">
                                    <input type="button" value="+" class="add">	
                                </div>
        
                                <a href="#" class="remove">
                                    <img src="./image/cart_can.svg" alt="remove">
                                    <img src="./image/cart_cano.svg" alt="remove">
                                </a>
                            </div>
                        </div>
                    </div>  
                        
                </div>

                <div class="list">
                    <div class="deco">
                        <div class="sticker-snow"><img src="./image/sticker_snow.svg" alt="sticker-snow"></div>

                        <div class="sticker-sun"><img src="./image/sticker_sun.svg" alt="sticker-sun"></div>
                    </div>

                    <h3>TOTAL</h3>

                    <div class="detail">
                        <span>PRODUCTS</span>
                        <span>$ <span id="sum2">1520</span></span>
                    </div>

                    <div class="detail">
                        <span>DISCOUNT</span>
                        <span>-$ <span id="discount">50</span></span>
                    </div>

                    <div class="detail">
                        <span>SHIPPING</span>
                        <span>$ <span id="shipping">60</span</span>
                    </div>

                    <div class="detailtotal">
                        <span>ORDER TOTAL</span>
                        <span>$ <span id="sum3">1530</span></span>
                    </div>

                    <a href="#" class="btn">CHECK OUT</a>
                </div>
            </div>

            <div class="product">
                <div class="title">
                    <h2>MAYBE YOU LIKE</h2>
                    <a href="shop.html" class="btn">MORE</a>
                </div>

                <div class="deco">
                    <div class="sticker-good"><img src="./image/sticker_good.svg" alt="sticker-good"></div>
                </div>

                <div class="itemgroup">
                    <div class="item">
                        <a href="shoppage.html">
                            <div class="top">
                                <span class="name">掌上電子遊戲機</span>

                                <div class="arrow2"><img src="./image/product_arrow2.svg" alt="arrow"></div>
                                <div class="arrow"><img src="./image/product_arrow.svg" alt="arrow"></div>
                                
                                <span class="detail">80年代經典電子遊戲機，帶您重溫當年的遊戲樂趣與童年回憶。</span>
                            </div>
                            
                            

                            <div class="bottom">
                                <span class="price">$ 980</span>
    
                                <span class="stamp1">NEW</span>
                            </div>

                            <div class="overlay"></div>
                            
                            <div class="primg">
                                <img src="./image/product_gameboy.jpg" alt="gameboy">
                            </div>
                        </a>
                    </div>

                    <div class="item">
                        <a href="shoppage.html">
                            <div class="top">
                                <span class="name">任天堂磁碟片</span>
                                
                                <div class="arrow2"><img src="./image/product_arrow2.svg" alt="arrow"></div>
                                <div class="arrow"><img src="./image/product_arrow.svg" alt="arrow"></div>
                                
                                <span class="detail">創新的遊戲媒介。成就了遊戲史上的經典，承載了無數令人難忘的冒險與故事。</span>
                            </div>
    
                            <div class="bottom">
                                <span class="price">$ 780</span>
    
                                <span class="stamp1">NEW</span>
                            </div>   

                            <div class="overlay"></div>
                            
                            <div class="primg">
                                <img src="./image/product_gamedisk.jpg" alt="gamedisk">
                            </div> 
                        </a>
                    </div>

                    <div class="item">
                        <a href="shoppage.html">
                            <div class="top">
                                <span class="name">音樂時光卡式錄音帶</span>
                                
                                <div class="arrow2"><img src="./image/product_arrow2.svg" alt="arrow"></div>
                                <div class="arrow"><img src="./image/product_arrow.svg" alt="arrow"></div>
                                
                                <span class="detail">充滿復古魅力的卡式錄音帶，帶您回到音樂在磁帶上流傳的年代，重溫那些珍貴的音樂時刻。</span>
                            </div>
    
                            <div class="bottom">
                                <span class="price">$ 360</span>
                            </div>   

                            <div class="overlay"></div>
                            
                            <div class="primg">
                                <img src="./image/product_audiotape.jpg" alt="audiotape">
                            </div>
                            
                        </a>
                    </div>

                    <div class="item">
                        <a href="shoppage.html">
                            <div class="top">
                                <span class="name">View-Master 幻燈片機</span>
                                
                                <div class="arrow2"><img src="./image/product_arrow2.svg" alt="arrow"></div>
                                <div class="arrow"><img src="./image/product_arrow.svg" alt="arrow"></div>
                                
                                <span class="detail">即刻探索多樣景觀，沉浸於生動故事。這經典裝置將美景帶入手中，成為您探險的視覺窗。</span>
                            </div>
    
                            <div class="bottom">
                                <span class="price">$ 600</span>
                            </div>   
                            
                            <div class="overlay"></div>

                            <div class="primg">
                                <img src="./image/product_viewmaster.jpg" alt="viewmaster">
                            </div>
                            
                        </a>
                    </div>
                    
                </div>
            </div>

        </div>

        <div id="footer"></div>
    </div>

    <script type="text/javascript">
        //在js中引入html
        $(document).ready(function () {
            $('#header').load('header.html');
            $('#footer').load('footer.html');
        });
    </script>

    <script>
        //add
        var adds = document.getElementsByClassName("add");
        //循環
        for (var i = 0; i < adds.length; i++) {
            //單擊事件
            adds[i].onclick = function () {
                //1.獲取輸入框對象
                var inputEle = this.previousElementSibling;
                //2.獲取原來的值
                var inputValue = inputEle.value;
                //3.重新複製
                inputEle.value = parseInt(inputValue) + 1;

                //計算金額
                //1.數量
                var number = parseInt(inputEle.value);
                //2.單價
                var commElement = this.closest('.item').querySelector(".comm");
                if (commElement !== null) {
                    var price = parseFloat(commElement.textContent);

                    //3.金額
                    var sum = number * price;

                    //4.賦值 保留2位小數點->toFixed(2)
                    this.closest('.item').querySelector(".total").textContent = sum;

                    //調用方法
                    getAmount();
                } else {
                    console.error(".comm element not found!");
                }
            }
        }

        //minus
        var minus = document.getElementsByClassName("minus");
        //循環
        for (var i = 0; i < minus.length; i++) {
            //單擊事件
            minus[i].onclick = function () {
                //1.獲取輸入框對象
                var inputEle = this.nextElementSibling;
                //2.獲取原來的值
                var inputValue = inputEle.value;
                //判斷
                if (parseInt(inputValue) > 1) {
                    //3.重新複製
                    inputEle.value = parseInt(inputValue) - 1;

                    //計算金額
                    //1.數量
                    var number = parseInt(inputEle.value);
                    //2.單價
                    var commElement = this.closest('.item').querySelector(".comm");
                    if (commElement !== null) {
                        var price = parseFloat(commElement.textContent);

                        //3.金額
                        var sum = number * price;

                        //4.賦值 保留2位小數點->toFixed(2)
                        this.closest('.item').querySelector(".total").textContent = sum;

                        //調用方法
                        getAmount();
                    } else {
                        console.error(".comm element not found!");
                    }
                }
            }
        }

        //刪除品項
        var removeItems = document.getElementsByClassName("remove");
        //循環
        for (var i = 0; i < removeItems.length; i++) {
            //點擊事件
            removeItems[i].onclick = function () {
                var itemToRemove = this.closest('.item');
                if (itemToRemove !== null) {
                    itemToRemove.remove();
                    // 調用方法重新計算金額
                    getAmount();
                } else {
                    // console.error("Item to remove not found!");
                }
            }
        }

        
        

        //計算金額
        function getAmount() {
            //0.累計和
            var sum = 0;
            //1.total
            var totals = document.getElementsByClassName("total");
            //2.循環
            for (var i = 0; i < totals.length; i++) {
                sum += parseFloat(totals[i].textContent);
            }

            //3.賦值
            document.getElementById("sum2").textContent = sum;
            // document.getElementById("sum3").textContent = sum - discount.textContent + shipping.textContent;
        

            // 設定折扣和運費
            var discount = document.getElementById("discount");
            var shipping = document.getElementById("shipping");

            var itemCount = document.querySelectorAll('.count input[type="text"]');
            var totalItems = 0;

            for (var j = 0; j < itemCount.length; j++) {
                totalItems += parseInt(itemCount[j].value);
            }

            var discountValue = 50; // 折扣金額
            var shippingCost = 60; // 運費金額
            var orderTotal = document.getElementById("sum3");

            if (totalItems === 0) {
                discount.innerHTML = 0;
                shipping.innerHTML = 0;
                orderTotal.innerHTML = 0; // 將總金額設為零
            } else {
                discount.innerHTML = discountValue;
                shipping.innerHTML = shippingCost;
                orderTotal.innerHTML = sum - discountValue + shippingCost;
            }
        }
    </script>
</body>
</html>